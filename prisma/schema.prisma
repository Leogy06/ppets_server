generator client {
  provider   = "prisma-client"
  output     = "../src/generated/client"
  engineType = "library"
}

datasource db {
  provider = "mysql"
}

model departmentTables {
  ID              Int       @id @default(autoincrement())
  DEPARTMENT_NAME String?   @db.Text
  CODE            String?   @db.VarChar(50)
  DESCRIPTION     String?   @db.Text
  OFFICER         String?   @db.VarChar(250)
  POSITION        String?   @db.VarChar(255)
  ENTRY_DATE      DateTime? @db.DateTime(0)

  @@index([ID], map: "ID")
}

model employees {
  ID             Int            @id @default(autoincrement())
  ID_NUMBER      Int
  FIRSTNAME      String         @db.VarChar(255)
  MIDDLENAME     String?        @db.VarChar(255)
  LASTNAME       String         @db.VarChar(255)
  SUFFIX         String?        @db.VarChar(255)
  DEPARTMENT_ID  Int?
  CURRENT_DPT_ID Int?
  CREATED_BY     Int?
  CREATED_WHEN   DateTime?      @db.DateTime(0)
  UPDATED_BY     Int?
  UPDATED_WHEN   DateTime?      @db.DateTime(0)
  DELETED        Int?           @db.TinyInt
  users          users[]
  transactions   transaction[]
  notifications  notification[]
  items          items[]
}

model users {
  id              Int       @id @default(autoincrement())
  emp_id          Int
  password        String    @db.VarChar(255)
  email           String?   @unique @db.VarChar(255)
  role            Int
  username        String?   @unique @db.VarChar(45)
  is_active       Int?      @default(1) @db.TinyInt
  DEPARTMENT_USER Int?
  employee        employees @relation(fields: [emp_id], references: [ID], onDelete: NoAction, map: "users_ibfk_1")

  transactions transaction[]

  @@index([emp_id], map: "emp_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model items {
  ID               Int           @id @unique(map: "ID") @default(autoincrement())
  ITEM_NAME        String        @db.VarChar(45)
  DESCRIPTION      String        @db.Text
  UNIT_VALUE       Decimal       @db.Decimal(10, 2)
  QUANTITY         Int
  originalQuantity Int
  RECEIVED_AT      DateTime      @db.DateTime(0)
  PIS_NO           String?       @db.VarChar(45)
  PROP_NO          String?       @db.VarChar(45)
  SERIAL_NO        String?       @db.VarChar(45)
  ICS_NO           String?       @db.VarChar(45)
  DEPARTMENT_ID    Int?
  REMARKS          String?       @db.Text
  DELETE           Int           @default(0) @db.TinyInt
  PAR_NO           String?       @db.VarChar(45)
  MR_NO            String?       @db.VarChar(45)
  ACCOUNT_CODE     Int?
  ADDED_BY         Int
  employee         employees     @relation(fields: [ADDED_BY], references: [ID])
  createdAt        DateTime?     @default(now()) @db.Timestamp(0)
  updatedAt        DateTime?     @default(now()) @db.Timestamp(0)
  condition        condition     @default(EXCELLENT)
  transactions     transaction[]

  @@index([ITEM_NAME])
  @@index([DELETE])
  @@index([ACCOUNT_CODE])
  @@index([DEPARTMENT_ID])
}

model account_item_tbl {
  ID            Int       @id @unique(map: "ID_UNIQUE") @default(autoincrement())
  ACCOUNT_CODE  String    @db.VarChar(45)
  ACCOUNT_TITLE String    @db.VarChar(90)
  createdAt     DateTime? @default(now()) @db.DateTime(0)
  updatedAt     DateTime? @default(now()) @db.DateTime(0)
  DELETED       Int?      @default(0) @db.TinyInt
}

enum condition {
  EXCELLENT
  GOOD
  FAIR
  POOR
  REPAIR
  MAINTENANCE
}

model transaction {
  id                  String                @id @default(uuid())
  status              status                @default(PENDING)
  reason              String                @db.VarChar(255)
  employeeId          Int
  employee            employees             @relation(fields: [employeeId], references: [ID])
  itemId              Int
  item                items                 @relation(fields: [itemId], references: [ID])
  quantity            Int
  reviewedAt          DateTime?
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @default(now())
  updatedBy           Int?
  updater             users?                @relation(fields: [updatedBy], references: [id])
  transactionConcerns transactionConcerns[]
}

model transactionConcerns {
  id            String      @id @default(uuid())
  transactionId String
  transaction   transaction @relation(fields: [transactionId], references: [id])
  message       String
  intentStatus  status
}

enum status {
  APPROVED
  PENDING
  REJECTED
  CANCEL
}

model notification {
  id         String    @id @default(uuid())
  read       read      @default(UNREAD)
  message    String    @db.VarChar(255)
  empId      Int
  employee   employees @relation(fields: [empId], references: [ID])
  readAt     DateTime?
  createadAt DateTime  @default(now())
}

enum read {
  READ
  UNREAD
}

model accountRequest {
  id          String    @id @default(uuid())
  requestedAt DateTime  @default(now())
  approvedAt  DateTime?
  employeeId  Int
  approve     Approved  @default(NO)
}

enum Approved {
  NO
  YES
}
